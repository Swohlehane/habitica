apiVersion: '2021-07-01'
location: westeurope
name: acg-habitica-prod-001
properties:
  containers:
  - name: aci-habiticaclient-prod-001
    properties:
      image: acrhabiticaprod001.azurecr.io/habitica_client:6c536c0
      command: ["npm", "run", "client:dev"]
      environmentVariables:
      - name: BASE_URL
        value: http://server:3000
      ports:
      - port: 8080
        protocol: TCP
      resources:
        requests:
          cpu: 1
          memoryInGB: 1
      volumeMounts:
      - name: logs-client
        mountPath: /root/.npm/_logs/
  - name: aci-habiticaserver-prod-001
    properties:
      image: acrhabiticaprod001.azurecr.io/habitica_server:6c536c0
      command: ["npm", "start", "build"]
      environmentVariables:
      - name: NODE_DB_URI
        value: mongodb://mongo/habitrpg
      ports:
      - port: 3000
        protocol: TCP
      resources:
        requests:
          cpu: 1
          memoryInGB: 1
      volumeMounts:
      - name: logs-server
        mountPath: /root/.npm/_logs/
  - name: aci-habiticamongo-prod-001
    properties:
      image: mongo:3.6
      ports:
      - port: 27017
        protocol: TCP
      resources:
          requests:
            cpu: 1
            memoryInGB: 1
      # volumeMounts:
      # - name: mongo-data
      #   mountPath: /data/db
  imageRegistryCredentials: # Credentials to pull a private image
  - server: acrhabiticaprod001.azurecr.io
    username: acrhabiticaprod001
    password: ERfyHBbeDseEeeqC6tIou7YZD3AJjSr187EqPKMF8Y+ACRAbYsoN
  ipAddress:
    ports:
    - protocol: tcp
      port: 8080
    - protocol: tcp
      port: 3000
    - protocol: tcp
      port: 27017
    type: private
  osType: Linux
  restartPolicy: Always
  subnetIds:
    - id: /subscriptions/93644b9f-d702-4207-8aef-cfc30f602e61/resourceGroups/rg-landingzone-prod-001/providers/Microsoft.Network/virtualNetworks/vnet-subs1105-euwe-001/subnets/snet-habitica-euwe-002
      name: snet-habitica-euwe-002
  dnsConfig:
    nameServers:
    - 10.240.0.228
    searchDomains: baugruppe.de
  volumes:
    - name: logs-client
      azureFile:
        shareName: logs-client
        storageAccountName: sthabiticaprod001
        storageAccountKey: OYFdAJBAV9icnq9IxEukfGNQAq1ARef5jo5z0ZZHAQzc+2vR0CcQMTXeB9HApByYM6nwC/Ga1BTB+AStaf3DDw==
    - name: logs-server
      azureFile:
        shareName: logs-server
        storageAccountName: sthabiticaprod001
        storageAccountKey: OYFdAJBAV9icnq9IxEukfGNQAq1ARef5jo5z0ZZHAQzc+2vR0CcQMTXeB9HApByYM6nwC/Ga1BTB+AStaf3DDw==
  #   - name: mongo-data
  #     azureFile:
  #       shareName: mongo-data
  #       storageAccountName: sthabiticaprod001
  #       storageAccountKey: OYFdAJBAV9icnq9IxEukfGNQAq1ARef5jo5z0ZZHAQzc+2vR0CcQMTXeB9HApByYM6nwC/Ga1BTB+AStaf3DDw==
tags: null
type: Microsoft.ContainerInstance/containerGroups
